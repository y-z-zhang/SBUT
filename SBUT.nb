(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     92051,       2198]
NotebookOptionsPosition[     85207,       2093]
NotebookOutlinePosition[     85643,       2110]
CellTagsIndexPosition[     85600,       2107]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Organizing a Matrix into Upper Triangular Blocks", "Section",
 CellChangeTimes->{{3.796589477929007*^9, 3.796589508390835*^9}, {
  3.833478411719138*^9, 
  3.833478421380517*^9}},ExpressionUUID->"5460e043-03c7-44eb-aefc-\
b885896ea875"],

Cell["\<\
Takes a matrix and, without changing the basis, gives an upper block \
triangular arrangement of its columns, namely an appropriately ordered list \
of column indices which form the blocks\
\>", "Text",
 CellChangeTimes->{{3.799414612727726*^9, 3.799414619446245*^9}, {
   3.799415066406357*^9, 3.79941516513525*^9}, 3.799432474097878*^9, 
   3.83347832941875*^9, {3.833478370207555*^9, 3.833478401132593*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4fc04739-6af6-45c9-b7e1-337219f01187"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"BlockSort", "[", "matrix_", "]"}], ":=", " ", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "b", ",", "l", ",", "adjacentcy", ",", "graphTot", ",", "graph", ",", 
       "adList", ",", "unusedInd", ",", "indexing", ",", " ", "added", " ", 
       ",", "c", ",", "paths", ",", "adj", ",", "j", ",", "newPaths", ",", 
       "i", ",", " ", "interval", ",", " ", "graphHere", ",", "addingHere", 
       ",", "lHere", ",", "indicesBlocks", ",", "toKeep"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"b", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"l", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "matrix", "]"}], "]"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"graphTot", "=", 
       RowBox[{"Adj", "[", "matrix", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"unusedInd", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{"1", ",", 
         RowBox[{"Length", "[", "matrix", "]"}]}], "]"}]}], ";", " ", 
      RowBox[{"(*", " ", 
       RowBox[{"indicies", " ", "of", " ", "original", " ", "columns"}], " ", 
       "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "Outermost", " ", "loop", " ", "lasts", " ", "while", " ", "there", 
        " ", "is", " ", "some", " ", "columns", " ", "left", " ", 
        "unindexed"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"Length", "[", "l", "]"}], ">", "0"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"paths", " ", "=", " ", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"indexing", "=", 
          RowBox[{"Flatten", "[", 
           RowBox[{"Position", "[", 
            RowBox[{"unusedInd", ",", "1"}], "]"}], "]"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "Flatten", " ", "is", " ", "used", " ", "here", " ", "to", " ", 
           "make", " ", "the", " ", "strange", " ", "output", " ", "of", " ", 
           "Position", " ", "usable"}], " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{"graph", "=", 
          RowBox[{"graphTot", "[", 
           RowBox[{"[", 
            RowBox[{"indexing", ",", "indexing"}], "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"newPaths", "=", 
          RowBox[{"{", 
           RowBox[{"{", "1", "}"}], "}"}]}], ";", " ", 
         RowBox[{"(*", " ", 
          RowBox[{
          "indicies", " ", "of", " ", "blocks", " ", "of", " ", "graph"}], 
          " ", "*)"}], "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"unusedInd", "[", 
           RowBox[{"[", 
            RowBox[{"indexing", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", "0"}], ";", 
         RowBox[{"(*", " ", 
          RowBox[{
          "showing", " ", "the", " ", "original", " ", "column", " ", "was", 
           " ", "used", " ", "in", " ", "this", " ", "step"}], " ", "*)"}], 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "while", " ", "new", " ", "paths", " ", "have", " ", "been", " ", 
           "added", " ", "by", " ", "the", " ", "previous", " ", "itteration",
            " ", "of", " ", "this", " ", "loop"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{"newPaths", "!=", "paths"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"paths", "=", "newPaths"}], ";", "\[IndentingNewLine]", 
            RowBox[{"newPaths", "=", 
             RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"adList", "=", 
             RowBox[{"Transpose", "[", "graph", "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"For", "[", 
             RowBox[{
              RowBox[{"i", "=", "1"}], ",", 
              RowBox[{"i", "\[LessEqual]", 
               RowBox[{"Length", "[", "paths", "]"}]}], ",", 
              RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
              RowBox[{
               RowBox[{"adj", "=", " ", 
                RowBox[{"Flatten", "[", 
                 RowBox[{"Position", "[", 
                  RowBox[{
                   RowBox[{"adList", "[", 
                    RowBox[{"[", 
                    RowBox[{"Last", "[", 
                    RowBox[{"paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "]"}], ",", 
                   "1"}], "]"}], "]"}]}], ";", "  ", 
               RowBox[{"(*", " ", 
                RowBox[{
                "list", " ", "of", " ", "indicies", " ", "of", " ", "blocks", 
                 " ", "connected", " ", "to", " ", "current", " ", 
                 "endpoint"}], " ", "*)"}], "\[IndentingNewLine]", 
               "\[IndentingNewLine]", 
               RowBox[{"(*", 
                RowBox[{
                "can", " ", "we", " ", "extend", " ", "the", " ", "ith", " ", 
                 "path"}], " ", "*)"}], "\[IndentingNewLine]", 
               RowBox[{"If", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"Length", "[", "adj", "]"}], "\[Equal]", "0"}], ",",
                  "\[IndentingNewLine]", 
                 RowBox[{"(*", 
                  RowBox[{"if", " ", "we", " ", 
                   RowBox[{"can", "'"}], 
                   RowBox[{"t", ":"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                 RowBox[{"AppendTo", "[", 
                  RowBox[{"newPaths", ",", 
                   RowBox[{"paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}]}], "]"}], ",", 
                 "\[IndentingNewLine]", "\[IndentingNewLine]", 
                 RowBox[{"(*", " ", 
                  RowBox[{
                   RowBox[{"if", " ", "we", " ", "can"}], ",", " ", 
                   RowBox[{
                   "iterate", " ", "over", " ", "every", " ", "possible", " ", 
                    RowBox[{"extension", ":"}]}]}], " ", "*)"}], 
                 "\[IndentingNewLine]", 
                 RowBox[{"For", "[", 
                  RowBox[{
                   RowBox[{"j", "=", "1"}], ",", 
                   RowBox[{"j", "\[LessEqual]", 
                    RowBox[{"Length", "[", "adj", "]"}]}], ",", 
                   RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"IntegerQ", "[", 
                    RowBox[{
                    RowBox[{"FirstPosition", "[", 
                    RowBox[{
                    RowBox[{"paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"adj", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], ",", " ", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "if", " ", "this", " ", "extension", " ", "makes", " ", 
                    "the", " ", "path", " ", "loop"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{"interval", "=", 
                    RowBox[{
                    RowBox[{"paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], "[", 
                    RowBox[{"[", " ", 
                    RowBox[{"Range", "[", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"FirstPosition", "[", 
                    RowBox[{
                    RowBox[{"paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"adj", "[", 
                    RowBox[{"[", "j", "]"}], "]"}]}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], ")"}], ",", 
                    RowBox[{"Length", "[", " ", 
                    RowBox[{"paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], " ", "]"}]}], " ", "]"}], 
                    " ", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"graph", "=", 
                    RowBox[{"MergeBlocks", "[", 
                    RowBox[{"graph", ",", " ", "interval"}], "]"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"l", "=", 
                    RowBox[{"MergeBlockLists", "[", 
                    RowBox[{"l", ",", 
                    RowBox[{"Sort", "[", "interval", "]"}]}], "]"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{"break", " ", "loops"}], " ", "*)"}], 
                    "\[IndentingNewLine]", 
                    RowBox[{"j", "=", 
                    RowBox[{
                    RowBox[{"Length", "[", "adj", "]"}], "+", "1"}]}], ";", 
                    "\[IndentingNewLine]", 
                    RowBox[{"i", "=", 
                    RowBox[{
                    RowBox[{"Length", "[", "paths", "]"}], "+", "1"}]}], ";", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    "reset", " ", "varaibles", " ", "to", " ", "begin", " ", 
                    "loop"}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{"paths", "=", 
                    RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
                    RowBox[{"newPaths", "=", 
                    RowBox[{"{", 
                    RowBox[{"{", "1", "}"}], "}"}]}]}], ",", 
                    "\[IndentingNewLine]", "\[IndentingNewLine]", 
                    RowBox[{"(*", " ", 
                    RowBox[{
                    RowBox[{"update", " ", "unusedInd"}], ",", " ", 
                    RowBox[{
                    "add", " ", "new", " ", "path", " ", "to", " ", 
                    "list"}]}], " ", "*)"}], "\[IndentingNewLine]", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"unusedInd", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"l", "[", 
                    RowBox[{"[", 
                    RowBox[{"adj", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
                    RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", "0"}], 
                    ";", "\[IndentingNewLine]", 
                    RowBox[{"AppendTo", "[", 
                    RowBox[{"newPaths", ",", 
                    RowBox[{"Join", "[", 
                    RowBox[{
                    RowBox[{"paths", "[", 
                    RowBox[{"[", "i", "]"}], "]"}], ",", 
                    RowBox[{"{", 
                    RowBox[{"adj", "[", 
                    RowBox[{"[", "j", "]"}], "]"}], "}"}]}], " ", "]"}]}], 
                    "]"}]}]}], "\[IndentingNewLine]", "]"}], ";"}]}], 
                  "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
                "]"}]}]}], "\[IndentingNewLine]", "]"}]}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         "\[IndentingNewLine]", 
         RowBox[{"(*", " ", 
          RowBox[{
          "find", " ", "the", " ", "vectors", " ", "which", " ", "have", " ", 
           "formed", " ", "part", " ", "of", " ", "the", " ", "above", " ", 
           "path", " ", "structure", " ", "to", " ", "add"}], " ", "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"addingHere", "=", 
          RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"For", "[", 
          RowBox[{
           RowBox[{"i", "=", "1"}], ",", 
           RowBox[{"i", "\[LessEqual]", 
            RowBox[{"Length", "[", "l", "]"}]}], ",", 
           RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"unusedInd", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"l", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "\[Equal]", 
              "0"}], ",", "\[IndentingNewLine]", 
             RowBox[{"AppendTo", "[", 
              RowBox[{"addingHere", ",", "i"}], "]"}], ",", 
             "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}]}], 
          "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
         RowBox[{"graphHere", "=", 
          RowBox[{"graph", "[", 
           RowBox[{"[", 
            RowBox[{"addingHere", ",", " ", "addingHere"}], "]"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"lHere", "=", 
          RowBox[{"l", "[", 
           RowBox[{"[", "addingHere", "]"}], "]"}]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"l", "=", 
          RowBox[{"Delete", "[", 
           RowBox[{"l", ",", 
            RowBox[{"Transpose", "[", 
             RowBox[{"{", "addingHere", "}"}], "]"}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"While", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"Length", "[", "graphHere", "]"}], ">", "0"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"indicesBlocks", "=", 
             RowBox[{"Flatten", "[", 
              RowBox[{"Position", "[", 
               RowBox[{
                RowBox[{"Transpose", "[", "graphHere", "]"}], ",", 
                RowBox[{"ConstantArray", "[", 
                 RowBox[{"0", ",", 
                  RowBox[{"Length", "[", "graphHere", "]"}]}], "]"}]}], "]"}],
               "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"b", "=", 
             RowBox[{"Join", "[", 
              RowBox[{"b", ",", 
               RowBox[{"lHere", "[", 
                RowBox[{"[", "indicesBlocks", "]"}], "]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"toKeep", "=", 
             RowBox[{"Complement", "[", 
              RowBox[{
               RowBox[{"Range", "[", 
                RowBox[{"Length", "[", "graphHere", "]"}], "]"}], ",", 
               "indicesBlocks"}], "]"}]}], ";", "\[IndentingNewLine]", 
            RowBox[{"addingHere", "=", 
             RowBox[{"addingHere", "[", 
              RowBox[{"[", "toKeep", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"lHere", "=", 
             RowBox[{"lHere", "[", 
              RowBox[{"[", "toKeep", "]"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"graphHere", " ", "=", " ", 
             RowBox[{"graphHere", "[", 
              RowBox[{"[", 
               RowBox[{"toKeep", ",", "toKeep"}], "]"}], "]"}]}], ";"}]}], 
          "\[IndentingNewLine]", "]"}], ";"}]}], "\[IndentingNewLine]", "]"}],
       ";", "\[IndentingNewLine]", "b"}]}], "\[IndentingNewLine]", "]"}]}], 
  "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7905732922149963`*^9, 3.790573381994437*^9}, 
   3.790573504065909*^9, {3.79057364747357*^9, 3.790573822180558*^9}, {
   3.790574207748416*^9, 3.7905742119526787`*^9}, {3.790574248128172*^9, 
   3.790574248288723*^9}, {3.7905742809410686`*^9, 3.790574294800424*^9}, 
   3.790591807012381*^9, {3.790592564083675*^9, 3.79059262223178*^9}, {
   3.790592695269124*^9, 3.7905927205068607`*^9}, {3.790592757492382*^9, 
   3.7905928476868134`*^9}, {3.790592890211412*^9, 3.7905929676836863`*^9}, {
   3.7905930741563053`*^9, 3.790593102726679*^9}, {3.790593140249053*^9, 
   3.790593439295423*^9}, {3.790593470527699*^9, 3.7905934734706697`*^9}, {
   3.790593674477117*^9, 3.790593763009808*^9}, {3.790593821192728*^9, 
   3.790593821811969*^9}, {3.790595266945612*^9, 3.790595271405127*^9}, {
   3.790595397822641*^9, 3.7905954176921673`*^9}, {3.7905954939839478`*^9, 
   3.790595532198802*^9}, {3.7905955918473177`*^9, 3.790595610232068*^9}, {
   3.7905956586106653`*^9, 3.7905956897629147`*^9}, 3.7905957491208687`*^9, {
   3.790595938341543*^9, 3.790595999484421*^9}, {3.7905960752352133`*^9, 
   3.790596075613957*^9}, {3.790596123947502*^9, 3.79059612580965*^9}, {
   3.790596252344198*^9, 3.79059625763993*^9}, {3.790596302044367*^9, 
   3.790596309515347*^9}, {3.790596377968471*^9, 3.790596394807211*^9}, {
   3.790596431268882*^9, 3.790596472254272*^9}, {3.79059653497077*^9, 
   3.7905965734536467`*^9}, {3.790596711988965*^9, 3.790596724355546*^9}, {
   3.790596766198183*^9, 3.79059678458764*^9}, {3.790596824117138*^9, 
   3.790596825383606*^9}, {3.790596873668611*^9, 3.790596930356777*^9}, {
   3.79059703319986*^9, 3.790597037616686*^9}, {3.790597098834086*^9, 
   3.790597388198234*^9}, {3.7905974405905247`*^9, 3.7905975458381977`*^9}, {
   3.790597577848143*^9, 3.7905975796900253`*^9}, {3.7905976323329163`*^9, 
   3.7905976488052588`*^9}, {3.790597719030757*^9, 3.790597722956169*^9}, {
   3.79061122474612*^9, 3.790611279263112*^9}, {3.790611314845208*^9, 
   3.790611346851254*^9}, {3.790611440264659*^9, 3.790611449471837*^9}, {
   3.790611564251247*^9, 3.790611568789298*^9}, {3.7906116343090677`*^9, 
   3.790611636038109*^9}, {3.7906117905438337`*^9, 3.790611857466288*^9}, {
   3.7906119424649277`*^9, 3.79061197022338*^9}, {3.7906120471169577`*^9, 
   3.7906120862270927`*^9}, {3.790620694057651*^9, 3.790620816793618*^9}, {
   3.790620922299856*^9, 3.790620938034841*^9}, {3.790621091756627*^9, 
   3.7906211043954697`*^9}, {3.790621391689762*^9, 3.790621397426998*^9}, {
   3.790621516242029*^9, 3.790621517034029*^9}, {3.790621554493795*^9, 
   3.790621591943421*^9}, {3.790628997300105*^9, 3.79062900665246*^9}, {
   3.7906290597483263`*^9, 3.790629108633095*^9}, {3.790629200558243*^9, 
   3.790629264295517*^9}, {3.790629348617557*^9, 3.790629356572638*^9}, {
   3.7906297668268003`*^9, 3.79062978214493*^9}, 3.791802461580607*^9, {
   3.791869282168315*^9, 3.791869369510028*^9}, {3.7918758199209633`*^9, 
   3.7918761516125307`*^9}, {3.7918761858070087`*^9, 3.791876423135437*^9}, {
   3.7918764641723337`*^9, 3.791876671968417*^9}, {3.7918767325372334`*^9, 
   3.791876738609509*^9}, {3.7918767999407177`*^9, 3.7918768053710203`*^9}, {
   3.791876931724386*^9, 3.791876936979*^9}, {3.791876991237795*^9, 
   3.791876993954165*^9}, 3.791877116262082*^9, {3.791887973224347*^9, 
   3.791887977437767*^9}, {3.7918880385228786`*^9, 3.7918880445642767`*^9}, {
   3.791888083077424*^9, 3.791888094311572*^9}, {3.791888248507365*^9, 
   3.791888336179147*^9}, {3.79188844655608*^9, 3.791888461297225*^9}, {
   3.792263099869268*^9, 3.792263102665407*^9}, {3.792263134883607*^9, 
   3.7922631589641438`*^9}, {3.7922632203779783`*^9, 3.792263486508189*^9}, {
   3.792263713949737*^9, 3.792263724343813*^9}, 3.792263792676865*^9, {
   3.792263844088221*^9, 3.79226397588372*^9}, {3.79226401409523*^9, 
   3.792264016149626*^9}, {3.792264064392844*^9, 3.792264127732534*^9}, {
   3.7922643454001207`*^9, 3.792264349454867*^9}, {3.792264389180401*^9, 
   3.792264436452125*^9}, {3.7922644741320143`*^9, 3.792264476795973*^9}, {
   3.792328830803318*^9, 3.7923288728374367`*^9}, {3.792328922065522*^9, 
   3.792328928426936*^9}, {3.79232917562074*^9, 3.7923291776208553`*^9}, {
   3.792329208828835*^9, 3.792329306555523*^9}, {3.792329342449402*^9, 
   3.792329353062801*^9}, 3.7923293945474453`*^9, {3.792329437276854*^9, 
   3.792329454965334*^9}, 3.792329490841015*^9, {3.792329533252863*^9, 
   3.792329610273786*^9}, {3.792337175246224*^9, 3.7923372219097977`*^9}, {
   3.792337253485589*^9, 3.792337296817576*^9}, {3.7923373290094337`*^9, 
   3.7923373327492733`*^9}, 3.792338346048254*^9, {3.792338477193778*^9, 
   3.792338520822652*^9}, {3.7923386008096933`*^9, 3.7923386101631737`*^9}, {
   3.79233888839915*^9, 3.792338894513612*^9}, {3.7923389344702063`*^9, 
   3.792339018531027*^9}, {3.796595180495693*^9, 3.7965952461293373`*^9}, {
   3.796595396421411*^9, 3.7965955275972*^9}, {3.796595558214199*^9, 
   3.796595633453402*^9}, {3.79659570625953*^9, 3.796595836325788*^9}, {
   3.7965959303854437`*^9, 3.796595949619519*^9}, {3.7966744888535013`*^9, 
   3.796674500473878*^9}, {3.796674621741572*^9, 3.796674622315995*^9}, {
   3.796674791840486*^9, 3.79667482271533*^9}, {3.7967268000492897`*^9, 
   3.796726843876465*^9}, 3.796727004280897*^9, {3.796730150920705*^9, 
   3.796730176162334*^9}, {3.79700177031234*^9, 3.797001772015257*^9}, {
   3.797049541179147*^9, 3.7970495598700666`*^9}, {3.797051514724826*^9, 
   3.797051519754468*^9}, {3.797051580758915*^9, 3.797051587255807*^9}, {
   3.797073841450283*^9, 3.7970738555372047`*^9}, {3.7970738990463943`*^9, 
   3.79707393878868*^9}, {3.797074022923931*^9, 3.797074035561146*^9}, 
   3.7970741903116817`*^9, {3.833478324627597*^9, 
   3.833478327135092*^9}},ExpressionUUID->"23b63a48-8466-4af0-9bbc-\
638489299f3f"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"MergeBlockLists", "[", 
    RowBox[{"list_", ",", "interval_"}], "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"toReturn", ",", "toReplace", ",", "i", ",", " ", "toRemove"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"toReplace", "=", 
       RowBox[{"{", "}"}]}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "interval", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"toReplace", "=", 
         RowBox[{"Union", "[", 
          RowBox[{"toReplace", ",", " ", 
           RowBox[{"list", "[", 
            RowBox[{"[", 
             RowBox[{"interval", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"toRemove", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"{", 
         RowBox[{"Rest", "[", "interval", "]"}], "}"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"toReturn", "=", 
       RowBox[{"Delete", "[", 
        RowBox[{"list", ",", "toRemove"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"toReturn", "[", 
        RowBox[{"[", 
         RowBox[{"interval", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "]"}], "]"}], "=", "toReplace"}], 
      ";", "\[IndentingNewLine]", "\[IndentingNewLine]", "toReturn"}]}], 
    "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]"}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.7905735675296793`*^9, 3.7905736076163473`*^9}, {
   3.7905738318183613`*^9, 3.790574075493121*^9}, {3.7905741056677027`*^9, 
   3.7905741071612597`*^9}, {3.790574143901973*^9, 3.790574201463685*^9}, {
   3.7905983288337507`*^9, 3.790598335667377*^9}, {3.790598867325625*^9, 
   3.79059888949853*^9}, {3.790598986210148*^9, 3.7905991907520514`*^9}, {
   3.790599314252359*^9, 3.790599319582446*^9}, 3.790599356827507*^9, {
   3.7905994031881027`*^9, 3.790599624038419*^9}, {3.790599685598885*^9, 
   3.790599809146806*^9}, {3.790599846175844*^9, 3.7905998955188932`*^9}, {
   3.7923376293099213`*^9, 3.792337870360455*^9}, {3.792337925919272*^9, 
   3.792337928792657*^9}, {3.792338085288719*^9, 3.792338100259384*^9}, {
   3.796703727973959*^9, 3.7967037389435663`*^9}, {3.7967042684490213`*^9, 
   3.796704277798935*^9}, {3.796704349751527*^9, 3.796704364423868*^9}, {
   3.796704401285411*^9, 3.796704477891364*^9}, {3.796704578089205*^9, 
   3.796704660515814*^9}, {3.796704692677022*^9, 3.796704847147403*^9}, {
   3.796726573433375*^9, 3.796726578258377*^9}, {3.796726609040106*^9, 
   3.7967266516896048`*^9}, {3.7967266850742683`*^9, 
   3.7967267123897667`*^9}, {3.7967269286533327`*^9, 3.7967269298248653`*^9}, 
   3.7967293450435743`*^9},
 CellLabel->"In[7]:=",ExpressionUUID->"fa0cb441-22b6-4122-a6da-082288353e6b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"MergeBlocks", "[", 
   RowBox[{"adj_", ",", "list_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
     "i", ",", "range", ",", "j", ",", "outRange", ",", "toReturn", ",", 
      "sorted", ",", "trans"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"range", "=", 
      RowBox[{"Range", "[", 
       RowBox[{"Length", "[", "adj", "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"sorted", "=", 
      RowBox[{"Sort", "[", 
       RowBox[{"list", ",", "Greater"}], "]"}]}], ";", "\[IndentingNewLine]", 
     
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "sorted", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"range", "=", 
        RowBox[{"Delete", "[", 
         RowBox[{"range", ",", 
          RowBox[{"sorted", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "\[IndentingNewLine]",
       "]"}], ";", "\[IndentingNewLine]", 
     RowBox[{"outRange", "=", "range"}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "range", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"outRange", "[", 
           RowBox[{"[", "i", "]"}], "]"}], ">", 
          RowBox[{"Last", "[", "sorted", "]"}]}], ",", "\[IndentingNewLine]", 
         
         RowBox[{
          RowBox[{"outRange", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "=", 
          RowBox[{"i", "+", "1"}]}], ",", "\[IndentingNewLine]", "Null"}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"toReturn", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Length", "[", "adj", "]"}], "-", 
           RowBox[{"Length", "[", "list", "]"}], "+", "1"}], ",", 
          RowBox[{
           RowBox[{"Length", "[", "adj", "]"}], "-", 
           RowBox[{"Length", "[", "list", "]"}], "+", "1"}]}], "}"}]}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "range", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"For", "[", 
        RowBox[{
         RowBox[{"j", "=", "1"}], ",", 
         RowBox[{"j", "\[LessEqual]", 
          RowBox[{"Length", "[", "range", "]"}]}], ",", 
         RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"adj", "[", 
              RowBox[{"[", 
               RowBox[{"range", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"range", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "\[Equal]", 
            "1"}], ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"toReturn", "[", 
              RowBox[{"[", 
               RowBox[{"outRange", "[", 
                RowBox[{"[", "j", "]"}], "]"}], "]"}], "]"}], "[", 
             RowBox[{"[", 
              RowBox[{"outRange", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", "1"}], ",", 
           "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}]}], 
        "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", "]"}], ";", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "range", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"trans", "=", 
         RowBox[{"Transpose", "[", "adj", "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"AllZeroes", "[", " ", 
            RowBox[{
             RowBox[{"trans", "[", 
              RowBox[{"[", " ", 
               RowBox[{"range", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], "[", 
             RowBox[{"[", "list", "]"}], "]"}], " ", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"toReturn", "[", 
             RowBox[{"[", 
              RowBox[{"Last", "[", "sorted", "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"outRange", "[", 
              RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "=", "1"}], ",", 
          "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"AllZeroes", "[", " ", 
            RowBox[{
             RowBox[{"adj", "[", 
              RowBox[{"[", " ", 
               RowBox[{"range", "[", 
                RowBox[{"[", "i", "]"}], "]"}], " ", "]"}], "]"}], "[", 
             RowBox[{"[", "list", "]"}], "]"}], " ", "]"}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"toReturn", "[", 
             RowBox[{"[", 
              RowBox[{"outRange", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}], "]"}], "[", 
            RowBox[{"[", 
             RowBox[{"Last", "[", "sorted", "]"}], "]"}], "]"}], "=", "1"}], 
          ",", "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", 
         "]"}]}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "toReturn"}]}], "\[IndentingNewLine]", "]"}]}]], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.790574415915638*^9, 3.790574416927737*^9}, {
   3.790597944951892*^9, 3.790597989605441*^9}, {3.7905980222294083`*^9, 
   3.790598036251678*^9}, {3.79059811052236*^9, 3.7905981150125713`*^9}, {
   3.79059824572611*^9, 3.7905983802019043`*^9}, {3.7905984249376373`*^9, 
   3.7905984448226833`*^9}, {3.7905984766754417`*^9, 3.79059850769726*^9}, {
   3.790598541964981*^9, 3.790598543737721*^9}, {3.790598613784294*^9, 
   3.79059861448759*^9}, 3.790598677355818*^9, {3.7905993035089273`*^9, 
   3.790599309655321*^9}, {3.7905993435795403`*^9, 3.790599351146269*^9}},
 CellLabel->"In[8]:=",ExpressionUUID->"91913ee2-1a6e-4bd5-a927-c172eb40bd62"],

Cell["\<\
Returns a matrix with a \[OpenCurlyQuote]1\[CloseCurlyQuote] in a place with \
a nonzero entry and \[OpenCurlyQuote]0\[CloseCurlyQuote] otherwise, recording \
the adjacency\
\>", "Text",
 CellChangeTimes->{{3.799414612727726*^9, 3.799414619446245*^9}, {
   3.799415066406357*^9, 3.79941516513525*^9}, 3.799432474097878*^9, {
   3.833478282980877*^9, 3.8334782866530046`*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"06f87ba3-80ad-4594-99fb-c04b7059a455"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Adj", "[", "matrix_", "]"}], ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"i", ",", "j", ",", "toReturn"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"toReturn", "=", 
       RowBox[{"ConstantArray", "[", 
        RowBox[{
         RowBox[{"-", "1"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Length", "[", "matrix", "]"}], ",", 
           RowBox[{"Length", "[", 
            RowBox[{"matrix", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "]"}]}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"For", "[", 
       RowBox[{
        RowBox[{"i", "=", "1"}], ",", 
        RowBox[{"i", "\[LessEqual]", 
         RowBox[{"Length", "[", "matrix", "]"}]}], ",", 
        RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
        RowBox[{"For", "[", 
         RowBox[{
          RowBox[{"j", "=", "1"}], ",", 
          RowBox[{"j", "\[LessEqual]", 
           RowBox[{"Length", "[", 
            RowBox[{"matrix", "[", 
             RowBox[{"[", "i", "]"}], "]"}], "]"}]}], ",", 
          RowBox[{"j", "++"}], ",", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"matrix", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "\[NotEqual]", "0"}], ",", 
               " ", 
               RowBox[{"i", "\[NotEqual]", "j"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toReturn", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", "1"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toReturn", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", "0"}]}], 
            "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"And", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"toReturn", "[", 
                  RowBox[{"[", "i", "]"}], "]"}], "[", 
                 RowBox[{"[", "j", "]"}], "]"}], "\[Equal]", 
                RowBox[{"-", "1"}]}], ",", " ", 
               RowBox[{"i", "\[NotEqual]", "j"}]}], "]"}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{
               RowBox[{"toReturn", "[", 
                RowBox[{"[", "i", "]"}], "]"}], "[", 
               RowBox[{"[", "j", "]"}], "]"}], "=", "1"}], ",", 
             "\[IndentingNewLine]", "Null"}], "\[IndentingNewLine]", "]"}], 
           ";"}]}], "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "toReturn"}]}], "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"AllZeroes", "[", "array_", "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"flat", ",", "i"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"flat", "=", 
      RowBox[{"Flatten", "[", "array", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{"i", "=", "1"}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"Length", "[", "flat", "]"}]}], ",", 
       RowBox[{"i", "++"}], ",", "\[IndentingNewLine]", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"flat", "[", 
           RowBox[{"[", "i", "]"}], "]"}], "\[Equal]", "0"}], ",", 
         "\[IndentingNewLine]", "Null", ",", "\[IndentingNewLine]", 
         RowBox[{"Return", "[", "False", "]"}]}], "\[IndentingNewLine]", 
        "]"}]}], "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
     "True"}]}], "]"}]}]}], "Input",
 InitializationCell->True,
 CellChangeTimes->{{3.797294196489791*^9, 3.797294272453435*^9}, {
  3.797294551718198*^9, 3.79729458980499*^9}, {3.8334782773567743`*^9, 
  3.8334782805715723`*^9}},ExpressionUUID->"401d215a-b9ad-4b6b-bfc3-\
de15640adf83"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Directed network with a master cluster and a slave cluster", "Section",
 CellChangeTimes->{{3.799414501327322*^9, 3.799414569685688*^9}, {
   3.799431102115837*^9, 3.799431123371296*^9}, {3.7994315390384417`*^9, 
   3.799431548299197*^9}, 3.799434340366502*^9},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"1af3b131-1015-4702-8f01-c6872791fa28"],

Cell[TextData[{
 "Adjacency matrix ",
 StyleBox["A", "Code"],
 " and diagonal matrices ",
 StyleBox["C1", "Code"],
 " and ",
 StyleBox["C2", "Code"],
 " encoding clusters"
}], "Text",
 CellChangeTimes->{{3.799414612727726*^9, 3.799414619446245*^9}, {
   3.799415066406357*^9, 3.79941516513525*^9}, 3.799432474097878*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7cf6321f-1332-46cb-b34a-dcb56cbdc51f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], 
      "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "1", ",", "0", ",", "1", ",", "1", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}],
     "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}],
     "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.799414669182939*^9, 3.799414841925218*^9}, {
  3.799414890057472*^9, 3.799414894962132*^9}, {3.799414925631233*^9, 
  3.799414977467211*^9}, {3.799415187035104*^9, 3.799415227321734*^9}, {
  3.799427966880003*^9, 3.7994280126530237`*^9}, {3.7994309291885643`*^9, 
  3.799430985340529*^9}},
 CellLabel->
  "In[179]:=",ExpressionUUID->"932da136-384c-4fc7-be3c-400de54af349"],

Cell[TextData[{
 "Convert adjacency matrix ",
 StyleBox["A", "Code"],
 " into Laplacian matrix ",
 StyleBox["L", "Code"]
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0cad96be-e5a4-488f-b56b-b05c74b79417"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Diag", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Total", "[", 
     RowBox[{"A", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"Diag", "-", "A"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.799415418428997*^9, 3.7994154498842487`*^9}, {
  3.799427907903132*^9, 3.799427923666253*^9}, {3.799428065980795*^9, 
  3.799428066743854*^9}, {3.833477490341374*^9, 3.8334774920437727`*^9}},
 CellLabel->
  "In[182]:=",ExpressionUUID->"8498ce66-8f8a-4624-ab01-bf0e080b9ad6"],

Cell[TextData[{
 "Generate a random combination ",
 StyleBox["M", "Code"],
 " of all generating matrices so we don\[CloseCurlyQuote]t have to worry \
about degeneracy (or use the form suggested in the paper for better alignment \
with clusters)"
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}, {3.799415525186016*^9, 
  3.799415568046137*^9}, {3.799415947907683*^9, 3.799415948232992*^9}, {
  3.799416031877707*^9, 3.799416043254402*^9}, {3.799431563724298*^9, 
  3.799431618460472*^9}, {3.7994316839605618`*^9, 3.799431705539885*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"0018c710-6a13-40ae-8c6d-c8e02b2b6177"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"RandomInteger", "[", "5", "]"}], "*", "L"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "5", "]"}], "*", "C1"}], " ", "+", " ", 
      RowBox[{
       RowBox[{"RandomInteger", "[", "5", "]"}], "*", "C2"}]}]}], ";"}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"M", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"RandomInteger", "[", "5", "]"}], "*", " ", 
      RowBox[{"C1", ".", "L", ".", "C1"}]}], " ", "+", " ", 
     RowBox[{
      RowBox[{"RandomInteger", "[", "5", "]"}], "*", 
      RowBox[{"C2", ".", "L", ".", "C2"}]}]}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.799415790153862*^9, 3.7994158483728867`*^9}, {
  3.7994158799116793`*^9, 3.7994159030968924`*^9}, {3.7994298601023207`*^9, 
  3.799429867068618*^9}, {3.7994299657312937`*^9, 3.799429972584841*^9}, {
  3.799430040407251*^9, 3.799430041148488*^9}, {3.799430502221736*^9, 
  3.799430561484057*^9}, {3.799430613559917*^9, 3.799430616105988*^9}, {
  3.799430748437825*^9, 3.7994307690038147`*^9}, {3.799430799966216*^9, 
  3.79943081574116*^9}, {3.7994317185900917`*^9, 3.799431720482313*^9}, {
  3.799432681155864*^9, 3.799432684091465*^9}, {3.799433221719895*^9, 
  3.799433259979487*^9}, {3.799435492098774*^9, 3.7994355023606167`*^9}, {
  3.833477474685519*^9, 3.8334774853201227`*^9}, {3.833477884813014*^9, 
  3.833477892658588*^9}, {3.833477955729766*^9, 3.833477958355105*^9}},
 CellLabel->
  "In[184]:=",ExpressionUUID->"4dd1750e-de88-4572-8aba-916d566c02c1"],

Cell[TextData[{
 "Find the basis for the common block upper triangular form by finding the \
Jordan decomposition of ",
 StyleBox["M", "Code"]
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}, {3.799415525186016*^9, 
  3.799415568046137*^9}, {3.799415947907683*^9, 3.799415948232992*^9}, {
  3.799416031877707*^9, 3.799416043254402*^9}, {3.799416111423686*^9, 
  3.799416163394915*^9}, {3.799432434311125*^9, 3.799432434546299*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"64815ffc-d461-459f-a938-6013deeb30eb"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s", ",", "j"}], "}"}], " ", "=", " ", 
   RowBox[{"JordanDecomposition", "[", "M", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"j", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.799415790153862*^9, 3.7994158483728867`*^9}, {
   3.7994158799116793`*^9, 3.7994159030968924`*^9}, {3.799416205956647*^9, 
   3.799416240175399*^9}, {3.7994163066010237`*^9, 3.7994163101111383`*^9}, 
   3.799431780099538*^9, {3.833409854992908*^9, 3.833409855364553*^9}},
 CellLabel->
  "In[185]:=",ExpressionUUID->"6241e3dc-9429-4598-b220-ddf509544a9c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "2", "0", "0", "0", "0", "0"},
     {"0", "0", "5", "1", "0", "0", "0"},
     {"0", "0", "0", "5", "0", "0", "0"},
     {"0", "0", "0", "0", "6", "0", "0"},
     {"0", "0", "0", "0", "0", "6", "0"},
     {"0", "0", "0", "0", "0", "0", "10"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.8334099658351793`*^9, 3.833477511774392*^9, 3.8334776610431137`*^9, 
   3.8334778979206467`*^9, {3.83347796493337*^9, 3.833477982701454*^9}},
 CellLabel->
  "Out[186]//MatrixForm=",ExpressionUUID->"37a47e09-039e-42b0-9ee9-\
536fa1184d27"]
}, Open  ]],

Cell[TextData[{
 "Find the form of ",
 StyleBox["L", "Code"],
 " under the similarity transformation ",
 StyleBox["s", "Code"]
}], "Text",
 CellChangeTimes->{{3.799431828189337*^9, 3.799431871732072*^9}, {
  3.7994321142424173`*^9, 3.799432167196562*^9}, {3.7994326963978643`*^9, 
  3.7994327079245*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"c431b7c6-fd98-4d28-a29a-699d7c86a795"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"Inverse", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TempL", " ", "=", " ", 
   RowBox[{"S", ".", "L", ".", "s"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7994176335202227`*^9, 3.799417641775072*^9}, {
  3.7994176872029943`*^9, 3.799417703831483*^9}, {3.7994282087096252`*^9, 
  3.7994282726043577`*^9}, {3.799428362806028*^9, 3.799428366312415*^9}, {
  3.799428415961931*^9, 3.799428418858419*^9}, {3.799428473672982*^9, 
  3.799428516387446*^9}, {3.799428592814047*^9, 3.799428600471874*^9}, {
  3.799429341468964*^9, 3.799429342052362*^9}, {3.799429470008029*^9, 
  3.799429487535706*^9}, {3.799431820837278*^9, 3.799431825290606*^9}, {
  3.799432125932681*^9, 3.799432127813827*^9}},
 CellLabel->
  "In[187]:=",ExpressionUUID->"c483ccaf-e364-41dd-9dd4-f1f440e7db8b"],

Cell[TextData[{
 "Use the BlockSort algorithm to reorder the basis ",
 StyleBox["s", "Code"],
 " so that it can be used to reveal the common block upper triangular form \
(here I am doing it manually because BlockSort didn\[CloseCurlyQuote]t seem \
to find the desired order)"
}], "Text",
 CellChangeTimes->{{3.799432182618843*^9, 3.799432205300385*^9}, {
  3.799432251560223*^9, 3.7994322740190773`*^9}, {3.79943230668435*^9, 
  3.799432316467209*^9}, {3.7994323688085213`*^9, 3.799432409009536*^9}, {
  3.79943271163017*^9, 3.799432745797324*^9}, {3.799433734011639*^9, 
  3.799433766250924*^9}, {3.799433806100019*^9, 3.799433830574748*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"6f243f2c-af6f-4ecd-8390-e68641535962"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"order", "=", 
  RowBox[{"BlockSort", "[", "TempL", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", " ", "=", " ", 
   RowBox[{"Flatten", "[", "order", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All"}], "]"}], "]"}], "=", 
   RowBox[{"s", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "order"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"s", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.799428707029374*^9, 3.79942871899384*^9}, {
   3.799429178478023*^9, 3.799429287893588*^9}, {3.79942980670231*^9, 
   3.7994298264554367`*^9}, {3.799431063743132*^9, 3.799431081540015*^9}, {
   3.799433718084161*^9, 3.7994337273795977`*^9}, {3.799433837668214*^9, 
   3.7994338615658092`*^9}, {3.7994339367909*^9, 3.799433938087586*^9}, {
   3.83340986471064*^9, 3.83340987147158*^9}, 3.8334776263507147`*^9},
 CellLabel->
  "In[189]:=",ExpressionUUID->"e7d3af2d-160e-461d-868d-18ad161b65ef"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "2", "}"}], ",", 
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "5", "}"}], ",", 
   RowBox[{"{", "7", "}"}], ",", 
   RowBox[{"{", "3", "}"}], ",", 
   RowBox[{"{", "6", "}"}], ",", 
   RowBox[{"{", "4", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.7994338853348913`*^9, 3.799433942749189*^9}, 
   3.833409965866234*^9, 3.833477536299588*^9, 3.833477670866003*^9, 
   3.833477897946315*^9, {3.833477964961917*^9, 3.833477982728215*^9}},
 CellLabel->
  "Out[189]=",ExpressionUUID->"d78e76db-0c68-44a6-af9f-b173a153e33c"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "1", "0", "0", "0", "0", "0"},
     {"0", "1", "0", "0", "0", "0", 
      RowBox[{"-", 
       FractionBox["1", "5"]}]},
     {"0", "1", "0", "0", "1", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "1", 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "1", "0", "1", "0"},
     {
      RowBox[{"-", "1"}], "0", "0", "1", "0", 
      RowBox[{"-", "1"}], "0"},
     {
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.7994338853348913`*^9, 3.799433942749189*^9}, 
   3.833409965866234*^9, 3.833477536299588*^9, 3.833477670866003*^9, 
   3.833477897946315*^9, {3.833477964961917*^9, 3.833477982729577*^9}},
 CellLabel->
  "Out[192]//MatrixForm=",ExpressionUUID->"4d8bce00-c49e-42c2-86ee-\
a2d945ac3c22"]
}, Open  ]],

Cell["The final common block upper triangular form", "Text",
 CellChangeTimes->{{3.799432797289091*^9, 3.799432805587009*^9}, {
  3.7994329130829353`*^9, 3.799432918319117*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"8e390278-c295-47ed-ab82-264219ba2f1e"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"Inverse", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FinalL", " ", "=", " ", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"S", ".", "L", ".", "s"}], "]"}], "//", 
   "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.7994296030779743`*^9, 3.7994296124863853`*^9}, 
   3.799432772696725*^9, 3.806016769931232*^9, {3.8334099543091717`*^9, 
   3.833409957644087*^9}, 3.8334776481292887`*^9},
 CellLabel->
  "In[193]:=",ExpressionUUID->"8df642f9-069a-4ce3-bde0-e36cec647d61"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "1", "0", "0", 
      FractionBox["1", "4"], "0", 
      RowBox[{"-", 
       FractionBox["1", "20"]}]},
     {"0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "3", "0", 
      FractionBox["1", "2"], "0", "0"},
     {"0", "0", "0", "5", 
      FractionBox["1", "4"], "0", 
      FractionBox["1", "20"]},
     {"0", "0", "0", "0", "1", "0", 
      FractionBox["1", "5"]},
     {"0", "0", "0", "0", "0", "3", 
      RowBox[{"-", 
       FractionBox["1", "10"]}]},
     {"0", "0", "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.799429613968975*^9, {3.799429672240766*^9, 3.799429702234066*^9}, 
   3.799429938062663*^9, 3.799430030351583*^9, 3.7994301906500587`*^9, 
   3.799430235374694*^9, 3.79943060185948*^9, 3.799430639437092*^9, 
   3.7994308426813374`*^9, 3.799432924935535*^9, {3.799433870483263*^9, 
   3.799433942900359*^9}, 3.8334099658912153`*^9, 3.833477547413596*^9, 
   3.833477683549266*^9, 3.833477897966549*^9, {3.833477964980383*^9, 
   3.833477982749028*^9}},
 CellLabel->
  "Out[194]//MatrixForm=",ExpressionUUID->"e381e595-c3ce-4ebb-9d47-\
5b47ee989f5a"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Directed network formed by four clusters with directional flow\
\>", "Section",
 CellChangeTimes->{{3.799414501327322*^9, 3.799414569685688*^9}, {
   3.799431102115837*^9, 3.799431123371296*^9}, {3.7994315390384417`*^9, 
   3.799431548299197*^9}, {3.79943332988188*^9, 3.7994333369940434`*^9}, 
   3.799434337562872*^9, 3.799450216938986*^9},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"7f5c136f-119a-4061-827d-814174dfecf0"],

Cell[TextData[{
 "Adjacency matrix ",
 StyleBox["A", "Code"],
 " and diagonal matrices ",
 StyleBox["C1", "Code"],
 " to ",
 StyleBox["C4", "Code"],
 " encoding clusters"
}], "Text",
 CellChangeTimes->{{3.799414612727726*^9, 3.799414619446245*^9}, {
   3.799415066406357*^9, 3.79941516513525*^9}, 3.799432474097878*^9, {
   3.7994333529107847`*^9, 3.799433355712551*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"bb89e550-324d-4017-a889-40d2c132179e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
       "1"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", 
       "0"}], "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
      "0"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
      "0"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C3", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0", ",", 
      "0"}], "}"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C4", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", 
      "1"}], "}"}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.799414669182939*^9, 3.799414841925218*^9}, {
  3.799414890057472*^9, 3.799414894962132*^9}, {3.799414925631233*^9, 
  3.799414977467211*^9}, {3.799415187035104*^9, 3.799415227321734*^9}, {
  3.799427966880003*^9, 3.7994280126530237`*^9}, {3.7994309291885643`*^9, 
  3.799430985340529*^9}, {3.799433368077129*^9, 3.7994334882064943`*^9}},
 CellLabel->
  "In[210]:=",ExpressionUUID->"217f7084-6fba-44d3-af1c-906e68cb988a"],

Cell[TextData[{
 "Convert adjacency matrix ",
 StyleBox["A", "Code"],
 " into Laplacian matrix ",
 StyleBox["L", "Code"]
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"23f519da-dc85-4889-8c36-d70368453d4b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Diag", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Total", "[", 
     RowBox[{"A", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"Diag", "-", "A"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.799415418428997*^9, 3.7994154498842487`*^9}, {
  3.799427907903132*^9, 3.799427923666253*^9}, {3.799428065980795*^9, 
  3.799428066743854*^9}},
 CellLabel->
  "In[215]:=",ExpressionUUID->"178c764a-3632-4e0e-94b4-61458c058c79"],

Cell[TextData[{
 "Generate a random combination ",
 StyleBox["M", "Code"],
 " of all generating matrices so we don\[CloseCurlyQuote]t have to worry \
about degeneracy (or use the form suggested in the paper for better alignment \
with clusters)"
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}, {3.799415525186016*^9, 
  3.799415568046137*^9}, {3.799415947907683*^9, 3.799415948232992*^9}, {
  3.799416031877707*^9, 3.799416043254402*^9}, {3.799431563724298*^9, 
  3.799431618460472*^9}, {3.7994316839605618`*^9, 3.799431705539885*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d317175d-9bc8-4c72-9f47-125149eecfba"],

Cell[BoxData[
 RowBox[{
  RowBox[{"M", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomInteger", "[", "5", "]"}], "*", " ", 
     RowBox[{"C1", ".", "L", ".", "C1"}]}], " ", "+", 
    RowBox[{
     RowBox[{"RandomInteger", "[", "5", "]"}], "*", 
     RowBox[{"C2", ".", "L", ".", "C2"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"RandomInteger", "[", "5", "]"}], "*", " ", 
     RowBox[{"C3", ".", "L", ".", "C3"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"RandomInteger", "[", "5", "]"}], "*", 
     RowBox[{"C4", ".", "L", ".", "C4"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.799415790153862*^9, 3.7994158483728867`*^9}, {
  3.7994158799116793`*^9, 3.7994159030968924`*^9}, {3.7994298601023207`*^9, 
  3.799429867068618*^9}, {3.7994299657312937`*^9, 3.799429972584841*^9}, {
  3.799430040407251*^9, 3.799430041148488*^9}, {3.799430502221736*^9, 
  3.799430561484057*^9}, {3.799430613559917*^9, 3.799430616105988*^9}, {
  3.799430748437825*^9, 3.7994307690038147`*^9}, {3.799430799966216*^9, 
  3.79943081574116*^9}, {3.7994317185900917`*^9, 3.799431720482313*^9}, {
  3.799432681155864*^9, 3.799432684091465*^9}, {3.799433221719895*^9, 
  3.799433259979487*^9}, {3.7994335155628777`*^9, 3.799433541045506*^9}, {
  3.799435479526174*^9, 3.799435481018751*^9}, {3.8334781856285553`*^9, 
  3.833478193977799*^9}},
 CellLabel->
  "In[217]:=",ExpressionUUID->"b2bd10a9-8fde-41b5-a098-9f08f980a0c5"],

Cell[TextData[{
 "Find the basis for the common block upper triangular form by finding the \
Jordan decomposition of ",
 StyleBox["M", "Code"]
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}, {3.799415525186016*^9, 
  3.799415568046137*^9}, {3.799415947907683*^9, 3.799415948232992*^9}, {
  3.799416031877707*^9, 3.799416043254402*^9}, {3.799416111423686*^9, 
  3.799416163394915*^9}, {3.799432434311125*^9, 3.799432434546299*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"d7c287d1-1977-4c8d-8a21-3f39bd151bfd"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s", ",", "j"}], "}"}], " ", "=", " ", 
   RowBox[{"JordanDecomposition", "[", "M", "]"}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"j", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.799415790153862*^9, 3.7994158483728867`*^9}, {
   3.7994158799116793`*^9, 3.7994159030968924`*^9}, {3.799416205956647*^9, 
   3.799416240175399*^9}, {3.7994163066010237`*^9, 3.7994163101111383`*^9}, 
   3.799431780099538*^9, {3.833410033450591*^9, 3.833410034210795*^9}},
 CellLabel->
  "In[218]:=",ExpressionUUID->"9750bfe9-d49f-45e9-a041-8162f4e1a03f"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "3", "0", "0", "0", "0", "0", "0"},
     {"0", "0", "4", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "4", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "8", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "9", "1", "0"},
     {"0", "0", "0", "0", "0", "0", "9", "0"},
     {"0", "0", "0", "0", "0", "0", "0", "12"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.833410053807705*^9, 3.833478218436308*^9},
 CellLabel->
  "Out[219]//MatrixForm=",ExpressionUUID->"f20c0277-e07c-4118-b8da-\
30f6f77335a9"]
}, Open  ]],

Cell[TextData[{
 "Find the form of ",
 StyleBox["L", "Code"],
 " under the similarity transformation ",
 StyleBox["s", "Code"]
}], "Text",
 CellChangeTimes->{{3.799431828189337*^9, 3.799431871732072*^9}, {
  3.7994321142424173`*^9, 3.799432167196562*^9}, {3.7994326963978643`*^9, 
  3.7994327079245*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"309945a4-bbb5-4ed6-baa8-b688957cbd1c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"Inverse", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TempL", " ", "=", " ", 
   RowBox[{"S", ".", "L", ".", "s"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7994176335202227`*^9, 3.799417641775072*^9}, {
  3.7994176872029943`*^9, 3.799417703831483*^9}, {3.7994282087096252`*^9, 
  3.7994282726043577`*^9}, {3.799428362806028*^9, 3.799428366312415*^9}, {
  3.799428415961931*^9, 3.799428418858419*^9}, {3.799428473672982*^9, 
  3.799428516387446*^9}, {3.799428592814047*^9, 3.799428600471874*^9}, {
  3.799429341468964*^9, 3.799429342052362*^9}, {3.799429470008029*^9, 
  3.799429487535706*^9}, {3.799431820837278*^9, 3.799431825290606*^9}, {
  3.799432125932681*^9, 3.799432127813827*^9}},
 CellLabel->
  "In[220]:=",ExpressionUUID->"e788af7e-52d7-4433-bd82-2ca4ca0d47d0"],

Cell[TextData[{
 "Use the BlockSort algorithm to reorder the basis ",
 StyleBox["s", "Code"],
 " so that it can be used to reveal the common block upper triangular form \
(here I am doing it manually because BlockSort didn\[CloseCurlyQuote]t seem \
to find the desired order)"
}], "Text",
 CellChangeTimes->{{3.799432182618843*^9, 3.799432205300385*^9}, {
  3.799432251560223*^9, 3.7994322740190773`*^9}, {3.79943230668435*^9, 
  3.799432316467209*^9}, {3.7994323688085213`*^9, 3.799432409009536*^9}, {
  3.79943271163017*^9, 3.799432745797324*^9}, {3.799433968167728*^9, 
  3.799433969723502*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"1d2ca214-5de9-4151-9cea-be4f8a36c5e8"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"order", "=", 
  RowBox[{"BlockSort", "[", "TempL", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", " ", "=", " ", 
   RowBox[{"Flatten", "[", "order", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All"}], "]"}], "]"}], "=", 
   RowBox[{"s", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "order"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"s", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.799428707029374*^9, 3.79942871899384*^9}, {
   3.799429178478023*^9, 3.799429287893588*^9}, {3.79942980670231*^9, 
   3.7994298264554367`*^9}, {3.799431063743132*^9, 3.799431081540015*^9}, {
   3.79943398833*^9, 3.79943404414145*^9}, {3.799434154644354*^9, 
   3.799434156887411*^9}, {3.799434230422418*^9, 3.799434264272257*^9}, {
   3.833410038503834*^9, 3.833410041407439*^9}, 3.83347814503302*^9},
 CellLabel->
  "In[222]:=",ExpressionUUID->"1fb9d47c-2aae-4fa5-bc46-f95918842ce5"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}], ",", 
   RowBox[{"{", "5", "}"}], ",", 
   RowBox[{"{", "6", "}"}], ",", 
   RowBox[{"{", "7", "}"}], ",", 
   RowBox[{"{", "8", "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.799434133267043*^9, 3.799434161328821*^9}, 
   3.799434270017941*^9, 3.8334100538325987`*^9, 3.833478218459116*^9},
 CellLabel->
  "Out[222]=",ExpressionUUID->"d162ab46-e632-4663-8455-6717732c1da1"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", "1", 
      FractionBox["1", "3"], "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", 
       FractionBox["2", "3"]}], "0"},
     {"0", 
      RowBox[{"-", "1"}], "0", "0", "0", 
      RowBox[{"-", "1"}], "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", "0", "0"},
     {"0", "0", "0", 
      RowBox[{"-", "1"}], "1", "0", "0", "0"},
     {"1", "0", "0", "0", "0", "0", "0", "0"},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", 
      RowBox[{"-", "1"}]},
     {"0", "0", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.799434133267043*^9, 3.799434161328821*^9}, 
   3.799434270017941*^9, 3.8334100538325987`*^9, 3.833478218460774*^9},
 CellLabel->
  "Out[225]//MatrixForm=",ExpressionUUID->"568a73fe-36cf-4aa7-8b0f-\
1a207c0c82cf"]
}, Open  ]],

Cell["The final common block upper triangular form", "Text",
 CellChangeTimes->{{3.799432797289091*^9, 3.799432805587009*^9}, {
  3.7994329130829353`*^9, 3.799432918319117*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"367c733f-3248-4c3a-9bdb-6ab55b8dff2b"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"Inverse", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FinalL", " ", "=", " ", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"S", ".", "L", ".", "s"}], "]"}], "//", 
   "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.7994296030779743`*^9, 3.7994296124863853`*^9}, 
   3.799432772696725*^9, {3.8060167063587637`*^9, 3.8060167065781603`*^9}, {
   3.8060167414899597`*^9, 3.806016748914418*^9}, {3.8334100465337887`*^9, 
   3.833410047374157*^9}, 3.833478154039599*^9},
 CellLabel->
  "In[226]:=",ExpressionUUID->"83023eb9-ef5b-491d-82dd-3e363dffd2dd"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0", "1", "1", "0", "0", "0"},
     {"0", "1", 
      RowBox[{"-", "1"}], "0", "0", "0", "0", 
      FractionBox["1", "2"]},
     {"1", "0", "1", "0", "0", "0", "0", "0"},
     {"0", 
      RowBox[{"-", "2"}], "0", "2", "0", 
      RowBox[{"-", "1"}], 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0"},
     {"0", "0", "0", "0", "4", "1", 
      FractionBox["1", "6"], "0"},
     {"0", "0", "0", "0", "0", "3", 
      FractionBox["1", "3"], 
      FractionBox["1", "2"]},
     {"0", "0", "0", "0", "0", "0", "3", 
      RowBox[{"-", "3"}]},
     {"0", "0", "0", "0", "0", "0", "0", "3"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.799429613968975*^9, {3.799429672240766*^9, 3.799429702234066*^9}, 
   3.799429938062663*^9, 3.799430030351583*^9, 3.7994301906500587`*^9, 
   3.799430235374694*^9, 3.79943060185948*^9, 3.799430639437092*^9, 
   3.7994308426813374`*^9, 3.799432924935535*^9, 3.799433584067801*^9, 
   3.799434059903391*^9, {3.799434133423438*^9, 3.799434161405292*^9}, 
   3.799434270194824*^9, 3.83341005383847*^9, 3.8334782184792633`*^9},
 CellLabel->
  "Out[227]//MatrixForm=",ExpressionUUID->"c6803061-310b-4483-a229-\
57c52cb25564"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two intertwined clusters with bi-directional flow", "Section",
 CellChangeTimes->{{3.799414501327322*^9, 3.799414569685688*^9}, {
   3.799431102115837*^9, 3.799431123371296*^9}, {3.7994315390384417`*^9, 
   3.799431548299197*^9}, 3.799434340366502*^9, {3.799450240204464*^9, 
   3.799450248965768*^9}},
 Background->RGBColor[
  0.94, 0.88, 0.94],ExpressionUUID->"4c9e1241-3bb6-4353-a7f5-2dbd8bd97255"],

Cell[TextData[{
 "Adjacency matrix ",
 StyleBox["A", "Code"],
 " and diagonal matrices ",
 StyleBox["C1", "Code"],
 " and ",
 StyleBox["C2", "Code"],
 " encoding clusters"
}], "Text",
 CellChangeTimes->{{3.799414612727726*^9, 3.799414619446245*^9}, {
   3.799415066406357*^9, 3.79941516513525*^9}, 3.799432474097878*^9},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"79789db5-0a58-4121-a8ce-20a1b4fe893b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"A", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "0", ",", "1"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "0", ",", "1", ",", "1", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"1", ",", "0", ",", "0", ",", "1", ",", "0", ",", "0"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0"}], 
      "}"}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C1", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0"}], "}"}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"C2", "=", " ", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1"}], "}"}], 
    "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.799414669182939*^9, 3.799414841925218*^9}, {
  3.799414890057472*^9, 3.799414894962132*^9}, {3.799414925631233*^9, 
  3.799414977467211*^9}, {3.799415187035104*^9, 3.799415227321734*^9}, {
  3.799427966880003*^9, 3.7994280126530237`*^9}, {3.7994309291885643`*^9, 
  3.799430985340529*^9}, {3.799450262421053*^9, 3.799450346162561*^9}},
 CellLabel->
  "In[195]:=",ExpressionUUID->"27502aac-fc75-46d6-85ca-d418bb441d1b"],

Cell[TextData[{
 "Convert adjacency matrix ",
 StyleBox["A", "Code"],
 " into Laplacian matrix ",
 StyleBox["L", "Code"]
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"70f51fce-b5be-4262-935d-06aeba1e5ffa"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Diag", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"Total", "[", 
     RowBox[{"A", ",", 
      RowBox[{"{", "2", "}"}]}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"L", "=", 
   RowBox[{"Diag", "-", "A"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.799415418428997*^9, 3.7994154498842487`*^9}, {
  3.799427907903132*^9, 3.799427923666253*^9}, {3.799428065980795*^9, 
  3.799428066743854*^9}},
 CellLabel->
  "In[198]:=",ExpressionUUID->"79a97773-3eb7-4324-87af-26e798af73c2"],

Cell[TextData[{
 "Generate a random combination ",
 StyleBox["M", "Code"],
 " of all generating matrices so we don\[CloseCurlyQuote]t have to worry \
about degeneracy (or use the form suggested in the paper for better alignment \
with clusters)"
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}, {3.799415525186016*^9, 
  3.799415568046137*^9}, {3.799415947907683*^9, 3.799415948232992*^9}, {
  3.799416031877707*^9, 3.799416043254402*^9}, {3.799431563724298*^9, 
  3.799431618460472*^9}, {3.7994316839605618`*^9, 3.799431705539885*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"7a77d5e9-bc09-42aa-9d16-4c5c1cf7e9bd"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"M", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomInteger", "[", "5", "]"}], "*", "L"}], " ", "+", 
    RowBox[{
     RowBox[{"RandomInteger", "[", "5", "]"}], "*", "C1"}], " ", "+", 
    RowBox[{
     RowBox[{"RandomInteger", "[", "5", "]"}], "*", "C2"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"M", " ", "=", 
     RowBox[{
      RowBox[{"C1", ".", "L", ".", "C1"}], " ", "+", 
      RowBox[{"C2", ".", "L", ".", "C2"}]}]}], ";"}], "*)"}]}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQXfDmSO15vzeOG95xt4LoKp2/HSB6n+TjbhBt5tYc
cw1IyxklxYLoQ2nbM0E0y/ZJWSDamIO3GERnHVAB02USx9eA6NRa/S0g+vqr
jbtAtGMK824QvYqp7zSIdpBXOAei7V7/uwiip27/fhlEczy65HIdSMvk87uC
6Gt/VPaCaI+3TWA6kXM7ww0g/TW8nhVEa2g2y9wE0jpdp2VBtITitbwHQLrt
xD0w/eMtbymIlljZVAaib+2K6QLRZVmivSC64STzGhDN/NoXTCtZLr8MomtF
9l4F0cveTm8/3v/G0bJepANEAwBPUKPq
  
  "],ExpressionUUID->"8ca1c399-8a15-4973-b525-9ad0bf02dd5f"],

Cell[TextData[{
 "Find the basis for the common block upper triangular form by finding the \
Jordan decomposition of ",
 StyleBox["M", "Code"]
}], "Text",
 CellChangeTimes->{{3.79941527009396*^9, 3.799415271078031*^9}, {
  3.79941530937466*^9, 3.799415378806513*^9}, {3.799415525186016*^9, 
  3.799415568046137*^9}, {3.799415947907683*^9, 3.799415948232992*^9}, {
  3.799416031877707*^9, 3.799416043254402*^9}, {3.799416111423686*^9, 
  3.799416163394915*^9}, {3.799432434311125*^9, 3.799432434546299*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"4bc18eb3-88ac-4c51-8fd2-58612a679d29"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"s", ",", "j"}], "}"}], " ", "=", " ", 
   RowBox[{"JordanDecomposition", "[", "M", "]"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.799415790153862*^9, 3.7994158483728867`*^9}, {
   3.7994158799116793`*^9, 3.7994159030968924`*^9}, {3.799416205956647*^9, 
   3.799416240175399*^9}, {3.7994163066010237`*^9, 3.7994163101111383`*^9}, 
   3.799431780099538*^9},
 CellLabel->
  "In[201]:=",ExpressionUUID->"7d4dfe14-c353-4609-a032-1156f42b172d"],

Cell[TextData[{
 "Find the form of ",
 StyleBox["L", "Code"],
 " under the similarity transformation ",
 StyleBox["s", "Code"]
}], "Text",
 CellChangeTimes->{{3.799431828189337*^9, 3.799431871732072*^9}, {
  3.7994321142424173`*^9, 3.799432167196562*^9}, {3.7994326963978643`*^9, 
  3.7994327079245*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"66b4d357-1431-4130-a358-a6e140584f0f"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"Inverse", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TempL", " ", "=", " ", 
   RowBox[{"S", ".", "L", ".", "s"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7994176335202227`*^9, 3.799417641775072*^9}, {
  3.7994176872029943`*^9, 3.799417703831483*^9}, {3.7994282087096252`*^9, 
  3.7994282726043577`*^9}, {3.799428362806028*^9, 3.799428366312415*^9}, {
  3.799428415961931*^9, 3.799428418858419*^9}, {3.799428473672982*^9, 
  3.799428516387446*^9}, {3.799428592814047*^9, 3.799428600471874*^9}, {
  3.799429341468964*^9, 3.799429342052362*^9}, {3.799429470008029*^9, 
  3.799429487535706*^9}, {3.799431820837278*^9, 3.799431825290606*^9}, {
  3.799432125932681*^9, 3.799432127813827*^9}},
 CellLabel->
  "In[202]:=",ExpressionUUID->"4a2efe1c-1b3a-44be-af68-8aa4f589c1ad"],

Cell[TextData[{
 "Use the BlockSort algorithm to reorder the basis ",
 StyleBox["s", "Code"],
 " so that it can be used to reveal the common block upper triangular form \
(here I am doing it manually because BlockSort didn\[CloseCurlyQuote]t seem \
to find the desired order)"
}], "Text",
 CellChangeTimes->{{3.799432182618843*^9, 3.799432205300385*^9}, {
  3.799432251560223*^9, 3.7994322740190773`*^9}, {3.79943230668435*^9, 
  3.799432316467209*^9}, {3.7994323688085213`*^9, 3.799432409009536*^9}, {
  3.79943271163017*^9, 3.799432745797324*^9}, {3.799433734011639*^9, 
  3.799433766250924*^9}, {3.799433806100019*^9, 3.799433830574748*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"bfc6ff9a-3d30-41e7-8dc2-d6a9e8956325"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"order", "=", 
  RowBox[{"BlockSort", "[", "TempL", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"order", " ", "=", " ", 
   RowBox[{"Flatten", "[", "order", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"s", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "All"}], "]"}], "]"}], "=", 
   RowBox[{"s", "[", 
    RowBox[{"[", 
     RowBox[{"All", ",", "order"}], "]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"s", "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.799428707029374*^9, 3.79942871899384*^9}, {
  3.799429178478023*^9, 3.799429287893588*^9}, {3.79942980670231*^9, 
  3.7994298264554367`*^9}, {3.799431063743132*^9, 3.799431081540015*^9}, {
  3.799433718084161*^9, 3.7994337273795977`*^9}, {3.799433837668214*^9, 
  3.7994338615658092`*^9}, {3.7994339367909*^9, 3.799433938087586*^9}, {
  3.799450381525877*^9, 3.7994503845132303`*^9}, {3.799450601883066*^9, 
  3.799450604900134*^9}, {3.7994510250604343`*^9, 3.799451030923307*^9}, {
  3.7994512163046007`*^9, 3.799451217832877*^9}, {3.799451762704636*^9, 
  3.799451797839579*^9}, {3.83310861959832*^9, 3.833108619784089*^9}, {
  3.833109732187416*^9, 3.833109732756873*^9}, {3.83340872028058*^9, 
  3.833408760758295*^9}},
 CellLabel->
  "In[204]:=",ExpressionUUID->"5166d9a5-c8d2-432e-9316-8f85ec3e8afc"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", "1", "}"}], ",", 
   RowBox[{"{", "4", "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "3", ",", "5", ",", "6"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.7994511873284693`*^9, 3.799451221784999*^9, 3.799451318613551*^9, {
   3.7994517781494207`*^9, 3.799451805711817*^9}, {3.833108614290208*^9, 
   3.8331086475077543`*^9}, 3.833408780157267*^9, 3.833478046954796*^9},
 CellLabel->
  "Out[204]=",ExpressionUUID->"532c43b9-c226-4cc0-9cf8-431e11ae5c45"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", 
      RowBox[{"-", "1"}], "0", 
      RowBox[{"-", 
       FractionBox["1", "4"]}], 
      FractionBox[
       RowBox[{"9", "+", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "9"}], "+", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]}], ")"}]}]]},
     {"1", "1", "0", "0", 
      FractionBox[
       RowBox[{"9", "+", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "9"}], "+", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]}], ")"}]}]]},
     {
      RowBox[{"-", "1"}], 
      RowBox[{"-", "1"}], "0", 
      FractionBox["1", "4"], 
      FractionBox[
       RowBox[{"9", "+", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "9"}], "+", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]}], ")"}]}]]},
     {
      RowBox[{"-", "1"}], "1", "0", "0", 
      FractionBox[
       RowBox[{"9", "+", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"3", "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]}], ")"}]}]], 
      FractionBox[
       RowBox[{
        RowBox[{"-", "9"}], "+", 
        RowBox[{"5", " ", 
         SqrtBox["3"]}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", 
           SqrtBox["3"]}]}], ")"}]}]]},
     {"0", "0", 
      FractionBox["1", "2"], "0", "1", "1"},
     {"0", "0", 
      RowBox[{"-", 
       FractionBox["1", "2"]}], "0", "1", "1"}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.7994511873284693`*^9, 3.799451221784999*^9, 3.799451318613551*^9, {
   3.7994517781494207`*^9, 3.799451805711817*^9}, {3.833108614290208*^9, 
   3.8331086475077543`*^9}, 3.833408780157267*^9, 3.833478046956153*^9},
 CellLabel->
  "Out[207]//MatrixForm=",ExpressionUUID->"222420e3-17a8-4acb-9a5c-\
965a09b2222b"]
}, Open  ]],

Cell["The final common block upper triangular form", "Text",
 CellChangeTimes->{{3.799432797289091*^9, 3.799432805587009*^9}, {
  3.7994329130829353`*^9, 3.799432918319117*^9}},
 Background->RGBColor[
  0.87, 0.94, 1],ExpressionUUID->"746d5a43-3fd3-493b-bd82-16a1449440c7"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"S", " ", "=", " ", 
   RowBox[{"Inverse", "[", "s", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FinalL", " ", "=", " ", 
  RowBox[{
   RowBox[{"Simplify", "[", 
    RowBox[{"S", ".", "L", ".", "s"}], "]"}], "//", 
   "MatrixForm"}]}]}], "Input",
 CellChangeTimes->{{3.7994296030779743`*^9, 3.7994296124863853`*^9}, 
   3.799432772696725*^9, {3.799451389342931*^9, 3.799451395726418*^9}, {
   3.799451435078732*^9, 3.7994514444701653`*^9}, {3.799451515941296*^9, 
   3.7994515415358553`*^9}, {3.79945158231382*^9, 3.79945158278277*^9}, {
   3.799451723523452*^9, 3.799451728565948*^9}, {3.833108668657436*^9, 
   3.833108747428082*^9}, {3.833109692854342*^9, 3.833109695253069*^9}, {
   3.83340881406404*^9, 3.833408816971622*^9}},
 CellLabel->
  "In[208]:=",ExpressionUUID->"2feb7f68-5496-42eb-aa4a-49510019c775"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"3", "0", 
      FractionBox["1", "2"], "0", "0", "0"},
     {"0", "5", "0", "0", "0", "0"},
     {"0", "0", "2", 
      FractionBox["1", "2"], "0", "0"},
     {"0", "0", "0", "3", "0", "0"},
     {"0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{"9", "-", 
         RowBox[{"5", " ", 
          SqrtBox["3"]}]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         SqrtBox["3"]}], ")"}]}]},
     {"0", "0", "0", "0", 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "-", 
         SqrtBox["3"]}], ")"}]}], 
      RowBox[{
       FractionBox["1", "6"], " ", 
       RowBox[{"(", 
        RowBox[{"9", "+", 
         RowBox[{"5", " ", 
          SqrtBox["3"]}]}], ")"}]}]}
    },
    GridBoxAlignment->{"Columns" -> {{Center}}, "Rows" -> {{Baseline}}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.8331097219642057`*^9, 3.833408836591365*^9, 
  3.833478046987235*^9},
 CellLabel->
  "Out[209]//MatrixForm=",ExpressionUUID->"6302fb6e-88f9-4d30-be59-\
2b0106c85c7b"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{961, 864},
WindowMargins->{{Automatic, -1231}, {34, Automatic}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.1 for Mac OS X x86 (64-bit) (June 19, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"67ce3ed1-864f-4ac4-979a-d39878da5240"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 242, 4, 67, "Section",ExpressionUUID->"5460e043-03c7-44eb-aefc-b885896ea875"],
Cell[825, 28, 516, 9, 74, "Text",ExpressionUUID->"4fc04739-6af6-45c9-b7e1-337219f01187"],
Cell[1344, 39, 21098, 410, 1748, "Input",ExpressionUUID->"23b63a48-8466-4af0-9bbc-638489299f3f",
 InitializationCell->True],
Cell[22445, 451, 3097, 64, 320, "Input",ExpressionUUID->"fa0cb441-22b6-4122-a6da-082288353e6b",
 InitializationCell->True],
Cell[25545, 517, 6763, 160, 824, "Input",ExpressionUUID->"91913ee2-1a6e-4bd5-a927-c172eb40bd62",
 InitializationCell->True],
Cell[32311, 679, 481, 9, 51, "Text",ExpressionUUID->"06f87ba3-80ad-4594-99fb-c04b7059a455"],
Cell[32795, 690, 4336, 109, 551, "Input",ExpressionUUID->"401d215a-b9ad-4b6b-bfc3-de15640adf83",
 InitializationCell->True]
}, Open  ]],
Cell[CellGroupData[{
Cell[37168, 804, 366, 5, 71, "Section",ExpressionUUID->"1af3b131-1015-4702-8f01-c6872791fa28"],
Cell[37537, 811, 416, 12, 51, "Text",ExpressionUUID->"7cf6321f-1332-46cb-b34a-dcb56cbdc51f"],
Cell[37956, 825, 1838, 53, 94, "Input",ExpressionUUID->"932da136-384c-4fc7-be3c-400de54af349"],
Cell[39797, 880, 341, 9, 51, "Text",ExpressionUUID->"0cad96be-e5a4-488f-b56b-b05c74b79417"],
Cell[40141, 891, 593, 14, 52, "Input",ExpressionUUID->"8498ce66-8f8a-4624-ab01-bf0e080b9ad6"],
Cell[40737, 907, 707, 13, 74, "Text",ExpressionUUID->"0018c710-6a13-40ae-8c6d-c8e02b2b6177"],
Cell[41447, 922, 1615, 34, 52, "Input",ExpressionUUID->"4dd1750e-de88-4572-8aba-916d566c02c1"],
Cell[43065, 958, 602, 11, 51, "Text",ExpressionUUID->"64815ffc-d461-459f-a938-6013deeb30eb"],
Cell[CellGroupData[{
Cell[43692, 973, 620, 13, 52, "Input",ExpressionUUID->"6241e3dc-9429-4598-b220-ddf509544a9c"],
Cell[44315, 988, 1006, 26, 144, "Output",ExpressionUUID->"37a47e09-039e-42b0-9ee9-536fa1184d27"]
}, Open  ]],
Cell[45336, 1017, 400, 10, 51, "Text",ExpressionUUID->"c431b7c6-fd98-4d28-a29a-699d7c86a795"],
Cell[45739, 1029, 868, 16, 52, "Input",ExpressionUUID->"c483ccaf-e364-41dd-9dd4-f1f440e7db8b"],
Cell[46610, 1047, 740, 13, 74, "Text",ExpressionUUID->"6f243f2c-af6f-4ecd-8390-e68641535962"],
Cell[CellGroupData[{
Cell[47375, 1064, 1032, 23, 94, "Input",ExpressionUUID->"e7d3af2d-160e-461d-868d-18ad161b65ef"],
Cell[48410, 1089, 584, 14, 34, "Output",ExpressionUUID->"d78e76db-0c68-44a6-af9f-b173a153e33c"],
Cell[48997, 1105, 1273, 36, 152, "Output",ExpressionUUID->"4d8bce00-c49e-42c2-86ee-a2d945ac3c22"]
}, Open  ]],
Cell[50285, 1144, 273, 4, 51, "Text",ExpressionUUID->"8e390278-c295-47ed-ab82-264219ba2f1e"],
Cell[CellGroupData[{
Cell[50583, 1152, 564, 13, 52, "Input",ExpressionUUID->"8df642f9-069a-4ce3-bde0-e36cec647d61"],
Cell[51150, 1167, 1539, 40, 184, "Output",ExpressionUUID->"e381e595-c3ce-4ebb-9d47-5b47ee989f5a"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52738, 1213, 451, 8, 71, "Section",ExpressionUUID->"7f5c136f-119a-4061-827d-814174dfecf0"],
Cell[53192, 1223, 467, 13, 51, "Text",ExpressionUUID->"bb89e550-324d-4017-a889-40d2c132179e"],
Cell[53662, 1238, 2605, 71, 136, "Input",ExpressionUUID->"217f7084-6fba-44d3-af1c-906e68cb988a"],
Cell[56270, 1311, 341, 9, 51, "Text",ExpressionUUID->"23f519da-dc85-4889-8c36-d70368453d4b"],
Cell[56614, 1322, 545, 14, 52, "Input",ExpressionUUID->"178c764a-3632-4e0e-94b4-61458c058c79"],
Cell[57162, 1338, 707, 13, 74, "Text",ExpressionUUID->"d317175d-9bc8-4c72-9f47-125149eecfba"],
Cell[57872, 1353, 1415, 28, 52, "Input",ExpressionUUID->"b2bd10a9-8fde-41b5-a098-9f08f980a0c5"],
Cell[59290, 1383, 602, 11, 51, "Text",ExpressionUUID->"d7c287d1-1977-4c8d-8a21-3f39bd151bfd"],
Cell[CellGroupData[{
Cell[59917, 1398, 620, 13, 52, "Input",ExpressionUUID->"9750bfe9-d49f-45e9-a041-8162f4e1a03f"],
Cell[60540, 1413, 986, 25, 162, "Output",ExpressionUUID->"f20c0277-e07c-4118-b8da-30f6f77335a9"]
}, Open  ]],
Cell[61541, 1441, 400, 10, 51, "Text",ExpressionUUID->"309945a4-bbb5-4ed6-baa8-b688957cbd1c"],
Cell[61944, 1453, 868, 16, 52, "Input",ExpressionUUID->"e788af7e-52d7-4433-bd82-2ca4ca0d47d0"],
Cell[62815, 1471, 694, 13, 74, "Text",ExpressionUUID->"1d2ca214-5de9-4151-9cea-be4f8a36c5e8"],
Cell[CellGroupData[{
Cell[63534, 1488, 1024, 23, 94, "Input",ExpressionUUID->"1fb9d47c-2aae-4fa5-bc46-f95918842ce5"],
Cell[64561, 1513, 489, 12, 34, "Output",ExpressionUUID->"d162ab46-e632-4663-8455-6717732c1da1"],
Cell[65053, 1527, 1374, 40, 178, "Output",ExpressionUUID->"568a73fe-36cf-4aa7-8b0f-1a207c0c82cf"]
}, Open  ]],
Cell[66442, 1570, 273, 4, 51, "Text",ExpressionUUID->"367c733f-3248-4c3a-9bdb-6ab55b8dff2b"],
Cell[CellGroupData[{
Cell[66740, 1578, 642, 14, 52, "Input",ExpressionUUID->"83023eb9-ef5b-491d-82dd-3e363dffd2dd"],
Cell[67385, 1594, 1604, 41, 194, "Output",ExpressionUUID->"c6803061-310b-4483-a229-57c52cb25564"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[69038, 1641, 407, 6, 71, "Section",ExpressionUUID->"4c9e1241-3bb6-4353-a7f5-2dbd8bd97255"],
Cell[69448, 1649, 416, 12, 51, "Text",ExpressionUUID->"79789db5-0a58-4121-a8ce-20a1b4fe893b"],
Cell[69867, 1663, 1618, 41, 94, "Input",ExpressionUUID->"27502aac-fc75-46d6-85ca-d418bb441d1b"],
Cell[71488, 1706, 341, 9, 51, "Text",ExpressionUUID->"70f51fce-b5be-4262-935d-06aeba1e5ffa"],
Cell[71832, 1717, 545, 14, 52, "Input",ExpressionUUID->"79a97773-3eb7-4324-87af-26e798af73c2"],
Cell[72380, 1733, 707, 13, 74, "Text",ExpressionUUID->"7a77d5e9-bc09-42aa-9d16-4c5c1cf7e9bd"],
Cell[73090, 1748, 989, 26, 52, "Input",ExpressionUUID->"8ca1c399-8a15-4973-b525-9ad0bf02dd5f"],
Cell[74082, 1776, 602, 11, 51, "Text",ExpressionUUID->"4bc18eb3-88ac-4c51-8fd2-58612a679d29"],
Cell[74687, 1789, 509, 11, 30, "Input",ExpressionUUID->"7d4dfe14-c353-4609-a032-1156f42b172d"],
Cell[75199, 1802, 400, 10, 51, "Text",ExpressionUUID->"66b4d357-1431-4130-a358-a6e140584f0f"],
Cell[75602, 1814, 868, 16, 52, "Input",ExpressionUUID->"4a2efe1c-1b3a-44be-af68-8aa4f589c1ad"],
Cell[76473, 1832, 740, 13, 74, "Text",ExpressionUUID->"bfc6ff9a-3d30-41e7-8dc2-d6a9e8956325"],
Cell[CellGroupData[{
Cell[77238, 1849, 1346, 28, 94, "Input",ExpressionUUID->"5166d9a5-c8d2-432e-9316-8f85ec3e8afc"],
Cell[78587, 1879, 522, 12, 34, "Output",ExpressionUUID->"532c43b9-c226-4cc0-9cf8-431e11ae5c45"],
Cell[79112, 1893, 3360, 116, 200, "Output",ExpressionUUID->"222420e3-17a8-4acb-9a5c-965a09b2222b"]
}, Open  ]],
Cell[82487, 2012, 273, 4, 51, "Text",ExpressionUUID->"746d5a43-3fd3-493b-bd82-16a1449440c7"],
Cell[CellGroupData[{
Cell[82785, 2020, 855, 17, 52, "Input",ExpressionUUID->"2feb7f68-5496-42eb-aa4a-49510019c775"],
Cell[83643, 2039, 1536, 50, 162, "Output",ExpressionUUID->"6302fb6e-88f9-4d30-be59-2b0106c85c7b"]
}, Open  ]]
}, Open  ]]
}
]
*)

